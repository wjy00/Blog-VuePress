<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>五、Express | Blog-WJY</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="WJY-Blog">
    
    <link rel="preload" href="/assets/css/0.styles.35bcedcf.css" as="style"><link rel="preload" href="/assets/js/app.61103f05.js" as="script"><link rel="preload" href="/assets/js/3.5422f50d.js" as="script"><link rel="preload" href="/assets/js/5.0bdab4d0.js" as="script"><link rel="prefetch" href="/assets/js/10.48398857.js"><link rel="prefetch" href="/assets/js/11.8b41c02f.js"><link rel="prefetch" href="/assets/js/12.b43b0fa5.js"><link rel="prefetch" href="/assets/js/13.8ebb1414.js"><link rel="prefetch" href="/assets/js/14.c83413f7.js"><link rel="prefetch" href="/assets/js/15.6112a6db.js"><link rel="prefetch" href="/assets/js/16.9821c622.js"><link rel="prefetch" href="/assets/js/17.24637ad6.js"><link rel="prefetch" href="/assets/js/18.ba05d0f7.js"><link rel="prefetch" href="/assets/js/19.398c37df.js"><link rel="prefetch" href="/assets/js/2.a5f5b41e.js"><link rel="prefetch" href="/assets/js/20.6175dbef.js"><link rel="prefetch" href="/assets/js/21.271e947a.js"><link rel="prefetch" href="/assets/js/22.b544afc3.js"><link rel="prefetch" href="/assets/js/23.3085b46b.js"><link rel="prefetch" href="/assets/js/24.f608e65b.js"><link rel="prefetch" href="/assets/js/25.64e77ea9.js"><link rel="prefetch" href="/assets/js/26.a6095427.js"><link rel="prefetch" href="/assets/js/27.aa814ee5.js"><link rel="prefetch" href="/assets/js/28.92fc9274.js"><link rel="prefetch" href="/assets/js/29.8689cd3d.js"><link rel="prefetch" href="/assets/js/30.8a913ce1.js"><link rel="prefetch" href="/assets/js/31.74c17c5a.js"><link rel="prefetch" href="/assets/js/32.a433e998.js"><link rel="prefetch" href="/assets/js/33.92f32f1c.js"><link rel="prefetch" href="/assets/js/34.6d1e7a32.js"><link rel="prefetch" href="/assets/js/35.b453475a.js"><link rel="prefetch" href="/assets/js/36.c22e7750.js"><link rel="prefetch" href="/assets/js/37.6c33872a.js"><link rel="prefetch" href="/assets/js/38.193c163f.js"><link rel="prefetch" href="/assets/js/39.ab325b65.js"><link rel="prefetch" href="/assets/js/4.594b49aa.js"><link rel="prefetch" href="/assets/js/40.f6c77657.js"><link rel="prefetch" href="/assets/js/41.99108772.js"><link rel="prefetch" href="/assets/js/42.729c9018.js"><link rel="prefetch" href="/assets/js/43.96c9b404.js"><link rel="prefetch" href="/assets/js/44.40e1b3eb.js"><link rel="prefetch" href="/assets/js/45.49720d5f.js"><link rel="prefetch" href="/assets/js/46.ee580737.js"><link rel="prefetch" href="/assets/js/47.de619698.js"><link rel="prefetch" href="/assets/js/48.e1a28b55.js"><link rel="prefetch" href="/assets/js/49.0bc2c3f6.js"><link rel="prefetch" href="/assets/js/50.180a5c62.js"><link rel="prefetch" href="/assets/js/51.6442c9c7.js"><link rel="prefetch" href="/assets/js/52.d65d7ff2.js"><link rel="prefetch" href="/assets/js/53.cabe401d.js"><link rel="prefetch" href="/assets/js/54.373c862c.js"><link rel="prefetch" href="/assets/js/55.48b13b1b.js"><link rel="prefetch" href="/assets/js/56.6e6b6725.js"><link rel="prefetch" href="/assets/js/57.41b3d131.js"><link rel="prefetch" href="/assets/js/58.6bd80af7.js"><link rel="prefetch" href="/assets/js/59.ab0b7ffc.js"><link rel="prefetch" href="/assets/js/6.0b7e2305.js"><link rel="prefetch" href="/assets/js/60.bd8bace5.js"><link rel="prefetch" href="/assets/js/61.07fc73df.js"><link rel="prefetch" href="/assets/js/7.81f0a449.js"><link rel="prefetch" href="/assets/js/8.880736f4.js"><link rel="prefetch" href="/assets/js/9.36b50a9e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.35bcedcf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/img/logo.png" alt="Blog-WJY" class="logo"> <span class="site-name can-hide">Blog-WJY</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  🏠 主页
</a></div><div class="nav-item"><a href="/about.html" class="nav-link">
  💗 关于
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="计算机基础" class="mobile-dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/computer/sa/" class="nav-link">
  数据结构与算法
</a></li><li class="dropdown-item"><!----> <a href="/computer/np/" class="nav-link">
  计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/computer/os/" class="nav-link">
  操作系统
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="HTML+CSS" class="dropdown-title"><span class="title">HTML+CSS</span> <span class="arrow down"></span></button> <button type="button" aria-label="HTML+CSS" class="mobile-dropdown-title"><span class="title">HTML+CSS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/htmlcss/html/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/htmlcss/css/" class="nav-link">
  CSS
</a></li></ul></div></div><div class="nav-item"><a href="/javascript/" class="nav-link">
  JavaScript
</a></div><div class="nav-item"><a href="/nodejs/" class="nav-link router-link-active">
  Node.js
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端框架" class="dropdown-title"><span class="title">前端框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端框架" class="mobile-dropdown-title"><span class="title">前端框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frame/vue/" class="nav-link">
  vue
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他知识" class="dropdown-title"><span class="title">其他知识</span> <span class="arrow down"></span></button> <button type="button" aria-label="其他知识" class="mobile-dropdown-title"><span class="title">其他知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/others/git/" class="nav-link">
  GIT
</a></li><li class="dropdown-item"><!----> <a href="/others/webpack/" class="nav-link">
  WEBPACK
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="⭐ 项目" class="dropdown-title"><span class="title">⭐ 项目</span> <span class="arrow down"></span></button> <button type="button" aria-label="⭐ 项目" class="mobile-dropdown-title"><span class="title">⭐ 项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="http://demo.wjy00.top:8899/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后台管理系统项目
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://demo.wjy00.top:8888/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  echart监控系统项目
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="/interview/" class="nav-link">
  💬 面经
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  🏠 主页
</a></div><div class="nav-item"><a href="/about.html" class="nav-link">
  💗 关于
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="计算机基础" class="mobile-dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/computer/sa/" class="nav-link">
  数据结构与算法
</a></li><li class="dropdown-item"><!----> <a href="/computer/np/" class="nav-link">
  计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/computer/os/" class="nav-link">
  操作系统
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="HTML+CSS" class="dropdown-title"><span class="title">HTML+CSS</span> <span class="arrow down"></span></button> <button type="button" aria-label="HTML+CSS" class="mobile-dropdown-title"><span class="title">HTML+CSS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/htmlcss/html/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/htmlcss/css/" class="nav-link">
  CSS
</a></li></ul></div></div><div class="nav-item"><a href="/javascript/" class="nav-link">
  JavaScript
</a></div><div class="nav-item"><a href="/nodejs/" class="nav-link router-link-active">
  Node.js
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端框架" class="dropdown-title"><span class="title">前端框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端框架" class="mobile-dropdown-title"><span class="title">前端框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frame/vue/" class="nav-link">
  vue
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他知识" class="dropdown-title"><span class="title">其他知识</span> <span class="arrow down"></span></button> <button type="button" aria-label="其他知识" class="mobile-dropdown-title"><span class="title">其他知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/others/git/" class="nav-link">
  GIT
</a></li><li class="dropdown-item"><!----> <a href="/others/webpack/" class="nav-link">
  WEBPACK
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="⭐ 项目" class="dropdown-title"><span class="title">⭐ 项目</span> <span class="arrow down"></span></button> <button type="button" aria-label="⭐ 项目" class="mobile-dropdown-title"><span class="title">⭐ 项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="http://demo.wjy00.top:8899/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后台管理系统项目
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://demo.wjy00.top:8888/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  echart监控系统项目
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="/interview/" class="nav-link">
  💬 面经
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>NODEJS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/nodejs/" aria-current="page" class="sidebar-link">Node.js</a></li><li><a href="/nodejs/1.内置模块.html" class="sidebar-link">一、内置模块</a></li><li><a href="/nodejs/2.插件及方法.html" class="sidebar-link">二、插件及方法</a></li><li><a href="/nodejs/3.创建静态Web服务器.html" class="sidebar-link">三、创建静态 Web 服务器</a></li><li><a href="/nodejs/4.模块化.html" class="sidebar-link">四、模块化</a></li><li><a href="/nodejs/5.Express.html" aria-current="page" class="active sidebar-link">五、Express</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nodejs/5.Express.html#_1-express-简介" class="sidebar-link">1. Express 简介</a></li><li class="sidebar-sub-header"><a href="/nodejs/5.Express.html#_2-express的基本使用" class="sidebar-link">2. Express的基本使用</a></li><li class="sidebar-sub-header"><a href="/nodejs/5.Express.html#_3-托管静态资源" class="sidebar-link">3. 托管静态资源</a></li><li class="sidebar-sub-header"><a href="/nodejs/5.Express.html#_4-express-路由" class="sidebar-link">4. Express 路由</a></li><li class="sidebar-sub-header"><a href="/nodejs/5.Express.html#_5-express-中间件" class="sidebar-link">5. Express 中间件</a></li><li class="sidebar-sub-header"><a href="/nodejs/5.Express.html#_6-使用-express-写接口" class="sidebar-link">6. 使用 Express 写接口</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="五、express"><a href="#五、express" class="header-anchor">#</a> 五、Express</h1> <h2 id="_1-express-简介"><a href="#_1-express-简介" class="header-anchor">#</a> 1. Express 简介</h2> <h3 id="_1-1-什么是-express"><a href="#_1-1-什么是-express" class="header-anchor">#</a> 1.1 什么是 Express</h3> <p><a href="https://www.expressjs.com.cn/" target="_blank" rel="noopener noreferrer"><strong>Express</strong><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 是基于 Node.js 平台，快速、开放、极简的 Web 开发框架。</p> <p><strong>通俗的理解</strong>：Express 的作用和 Node.js 内置的 http 模块类似，是专门用来创建 Web 服务器的。</p> <p><strong>本质</strong>：就是一个 npm 上的第三方包，提供了快速创建 Web 服务器的便捷方法。</p> <h3 id="_1-2-express-能做什么"><a href="#_1-2-express-能做什么" class="header-anchor">#</a> 1.2 Express 能做什么</h3> <p>对于前端程序员来说，最常见的<strong>两种</strong>服务器，分别是：</p> <ul><li><strong>Web 网站服务器</strong>：专门对外提供 Web 网页资源的服务器。</li> <li><strong>API 接口服务器</strong>：专门对外提供 API 接口的服务器。</li></ul> <p>使用 Express，我们可以方便、快速的创建 Web 网站的服务器或 API 接口的服务器。</p> <h2 id="_2-express的基本使用"><a href="#_2-express的基本使用" class="header-anchor">#</a> 2. Express的基本使用</h2> <h3 id="_2-1-安装"><a href="#_2-1-安装" class="header-anchor">#</a> 2.1 安装</h3> <p>在项目目录中，输入以下终端命令：</p> <div class="language- extra-class"><pre class="language-text"><code>npm i express
</code></pre></div><h3 id="_2-2-创建基本的-web-服务器"><a href="#_2-2-创建基本的-web-服务器" class="header-anchor">#</a> 2.2 创建基本的 Web 服务器</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1. 导入express</span>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span>
<span class="token comment">// 2. 创建 web 服务器</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 3. 启动 web 服务器</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'express server running at http://127.0.0.1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>可以使用 <code>node-snippets</code> 插件快速创建，输入 <code>nodeexpress</code> 即可。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> port <span class="token operator">=</span> <span class="token number">3000</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Hello World!'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Example app listening on port </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_2-3-监听-get-请求"><a href="#_2-3-监听-get-请求" class="header-anchor">#</a> 2.3 监听 GET 请求</h3> <p>通过 <code>app.get()</code> 方法，可以监听客户端的 GET 请求，具体的语法格式如下：</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'请求URL'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">/*处理函数*/</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>参数1：客户端请求的URL地址</li> <li>参数2：请求对应的处理函数   req：请求对象   res：响应对象</li></ul> <h3 id="_2-4-监听-post-请求"><a href="#_2-4-监听-post-请求" class="header-anchor">#</a> 2.4 监听 POST 请求</h3> <p>通过 <code>app.post()</code> 方法，可以监听客户端的 POST 请求，具体的语法格式如下：</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'请求URL'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">/*处理函数*/</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_2-5-把内容响应给客户端"><a href="#_2-5-把内容响应给客户端" class="header-anchor">#</a> 2.5 把内容响应给客户端</h3> <p>通过 <code>res.send()</code> 方法，可以把处理好的内容，发送给客户端：</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/user'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 向客户端发送JSON对象</span>
  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'ZhangSan'</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/user'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 向客户端发送文本信息</span>
  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'请求成功'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_2-6-获取-url-中携带的查询参数"><a href="#_2-6-获取-url-中携带的查询参数" class="header-anchor">#</a> 2.6 获取 URL 中携带的查询参数</h3> <p>通过 <strong><code>req.query</code></strong> 对象，可以访问到客户端通过<strong>查询字符串</strong>的形式，发送到服务器的参数：</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// req.query 默认是一个空对象</span>
  <span class="token comment">// 客户端使用 ?name=za&amp;age=20 这种查询字符串形式，发送到服务器的参数，可以通过 req.query 对象访问到，例如：</span>
  <span class="token comment">// req.query.name   req.query.age</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_2-7-获取-url-中的动态参数"><a href="#_2-7-获取-url-中的动态参数" class="header-anchor">#</a> 2.7 获取 URL 中的动态参数</h3> <p>通过 <strong><code>req.params</code></strong> 对象，可以访问到 URL 中，通过 <code>:参数名</code>匹配<strong>动态参数</strong>：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// URL 地址中，可以通过 :参数名 的形式，匹配动态参数值</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/user/:id'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// req.params 默认是一个空对象</span>
  <span class="token comment">// 里面存放着通过 : 动态匹配到的参数值</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>params<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_3-托管静态资源"><a href="#_3-托管静态资源" class="header-anchor">#</a> 3. 托管静态资源</h2> <h3 id="_3-1-express-static"><a href="#_3-1-express-static" class="header-anchor">#</a> 3.1 express.static()</h3> <p>express 提供了一个非常好用的函数，叫做 <strong><code>express.static()</code></strong>，通过它，我们可以非常方便地创建一个静态资源服务器，例如，通过如下代码就可以将 public 目录下的图片、CSS 文件、JavaScript 文件对外开放访问了：</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">'public'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>就可以访问 public 目录中的所有文件了：</p> <ul><li>http://localhost:3000/images/bg.jpg</li> <li>http://localhost:3000/css/style.css</li> <li>http://localhost:3000/js/login.js</li></ul> <p>**注意：**Express 在指定的静态目录中查找文件，并对外提供资源的访问路径。因此，存放静态文件的目录名不会出现在 URL 中。</p> <h3 id="_3-2-托管多个静态资源目录"><a href="#_3-2-托管多个静态资源目录" class="header-anchor">#</a> 3.2 托管多个静态资源目录</h3> <p>如果要托管多个静态资源目录，需要多次调用 express.static() 函数</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">'public'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">'files'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>访问静态资源文件时，express.static() 函数会根据目录的添加顺序查找所需的文件。</p> <h3 id="_3-3-挂载路径前缀"><a href="#_3-3-挂载路径前缀" class="header-anchor">#</a> 3.3 挂载路径前缀</h3> <p>如果希望在托管的静态资源访问路径之前，<strong>挂载路径前缀</strong>，则可以使用如下的方式：</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/public'</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">'public'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>就可以通过带有 <code>/public</code> 前缀地址来访问 public 目录中的文件了：</p> <ul><li>http://localhost:3000/public/images/bg.jpg</li> <li>http://localhost:3000/public/css/style.css</li> <li>http://localhost:3000/public/js/login.js</li></ul> <h2 id="_4-express-路由"><a href="#_4-express-路由" class="header-anchor">#</a> 4. Express 路由</h2> <h3 id="_4-1-express-中的路由"><a href="#_4-1-express-中的路由" class="header-anchor">#</a> 4.1 Express 中的路由</h3> <p>在 Express 中，路由指的是<strong>客户端的请求</strong>与<strong>服务器处理函数</strong>之间的映射关系。</p> <p>Express 中的路由分 3 部分组成，分别是<strong>请求的类型</strong><code>(METHOD)</code>、<strong>请求的 URL 地址</strong><code>(PATH)</code>、<strong>处理函数</strong><code>(HANDLER)</code>，格式如下：</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token constant">METHOD</span><span class="token punctuation">(</span><span class="token constant">PATH</span><span class="token punctuation">,</span> <span class="token constant">HANDLER</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_4-2-路由的匹配过程"><a href="#_4-2-路由的匹配过程" class="header-anchor">#</a> 4.2 路由的匹配过程</h3> <p>每当一个请求到达服务器之后，需要<strong>先经过路由的匹配</strong>，只有匹配成功之后，才会调用对应的处理函数。</p> <p>在匹配时，会按照路由的顺序进行匹配，如果<strong>请求类型</strong>和<strong>请求的 URL</strong> 同时匹配成功，则 Express 会将这次请求，转交给对应的 function 函数进行处理。</p> <p><img src="/assets/img/router.b00a4bc0.png" alt=""></p> <p>注意点：</p> <ul><li>按照定义的先后顺序进行匹配</li> <li>请求类型和请求的URL同时匹配成功，才会调用对应的处理函数</li></ul> <h3 id="_4-3-模块化路由"><a href="#_4-3-模块化路由" class="header-anchor">#</a> 4.3 模块化路由</h3> <p>为了方便对路由进行模块化的管理，Express <strong>不建议</strong>将路由直接挂载到 app 上，而是推荐将路由抽离为单独的模块。</p> <p>将路由抽离为单独模块的步骤如下：</p> <ul><li>创建路由模块对应的 .js 文件</li> <li>调用 <code>express.Router()</code> 函数创建路由对象</li> <li>向路由对象上挂载具体的路由</li> <li>使用 <code>module.exports</code> 向外共享路由对象</li> <li>使用 <code>app.use()</code> 函数注册路由模块</li></ul> <ol><li><p>创建路由模块</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1. 引入express模块</span>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span>
<span class="token comment">// 2. 创建路由对象</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 3. 挂载具体的路由</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/user/list'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Get user list.'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/user/add'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Add new user.'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 4，向外导出路由对象</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router
</code></pre></div></li> <li><p>注册路由模块</p> <p>在 <code>app.js</code> 中导入并使用路由模块</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1. 导入路由模块</span>
<span class="token keyword">const</span> userRouter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./router/user.js'</span><span class="token punctuation">)</span>

<span class="token comment">// 2. 使用 app.use() 注册路由模块</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>userRouter<span class="token punctuation">)</span>
</code></pre></div></li> <li><p>为路由模块添加前缀</p> <p>类似于托管静态资源时，为静态资源统一挂载访问前缀一样，路由模块添加前缀的方式：</p> <div class="language- extra-class"><pre class="language-text"><code>// 1. 导入路由模块
const userRouter = require('./router/user.js')

// 2. 使用 app.use() 注册路由模块，并添加统一的访问前缀 /api
app.use('/api', userRouter)
</code></pre></div></li></ol> <h2 id="_5-express-中间件"><a href="#_5-express-中间件" class="header-anchor">#</a> 5. Express 中间件</h2> <blockquote><p>中间件（Middleware），特指业务流程的中间处理环节。</p></blockquote> <h3 id="_5-1-中间件的调用流程"><a href="#_5-1-中间件的调用流程" class="header-anchor">#</a> 5.1 中间件的调用流程</h3> <p>当一个请求到达 Express 的服务器之后，可以连续调用多个中间件，从而对这次请求进行预处理。</p> <p><img src="/assets/img/middleware.1141e6cf.png" alt=""></p> <h3 id="_5-2-中间件的格式"><a href="#_5-2-中间件的格式" class="header-anchor">#</a> 5.2  中间件的格式</h3> <p>Express 的中间件，本质上就是一个 <strong>function 处理函数</strong>，Express 中间件的格式如下：</p> <p><img src="/assets/img/middleware1.5fd17820.png" alt=""></p> <p>注意：中间件函数的形参列表中，<strong>必须包含</strong> <strong>next 参数</strong>。而路由处理函数中只包含 req 和 res。</p> <blockquote><p><strong>next 函数</strong>是实现多个中间件连续调用的关键，它表示把流转关系转交给下一个中间件或路由。</p></blockquote> <h3 id="_5-3-中间件的使用"><a href="#_5-3-中间件的使用" class="header-anchor">#</a> 5.3 中间件的使用</h3> <h4 id="_1-定义中间件函数"><a href="#_1-定义中间件函数" class="header-anchor">#</a> ① 定义中间件函数</h4> <p>通过如下的方式，定义一个最简单的中间件函数：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">mw</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'一个最简单的中间件函数'</span><span class="token punctuation">)</span>
  <span class="token comment">// 注意：在当前中间件的业务处理完毕后，必须调用 next() 函数</span>
  <span class="token comment">// 表示把当前流转关系转交给下一个中间件或路由</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_2-全局生效的中间件"><a href="#_2-全局生效的中间件" class="header-anchor">#</a> ② <strong>全局生效</strong>的中间件</h4> <p>客户端发起的任何请求，到达服务器之后，都会触发的中间件，叫做全局生效的中间件。</p> <p>通过调用 <code>app.use(中间件函数)</code>，即可定义一个全局生效的中间件，示例代码如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">mw</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'一个最简单的中间件函数'</span><span class="token punctuation">)</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>mw<span class="token punctuation">)</span>
</code></pre></div><p>简化形式：</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'一个最简单的中间件函数'</span><span class="token punctuation">)</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="_3-中间件的作用"><a href="#_3-中间件的作用" class="header-anchor">#</a> ③ 中间件的作用</h4> <p>多个中间件之间，<strong>共享同一份</strong> <strong>req</strong> <strong>和</strong> <strong>res</strong>。</p> <p>基于这样的特性，<u>我们可以在上游的中间件中，统一为 req 或 res 对象添加自定义的属性或方法</u>，供下游的中间件或路由进行使用。</p> <p><img src="/assets/img/middleware2.83b8f54e.png" alt=""></p> <h4 id="_4-定义多个全局中间件"><a href="#_4-定义多个全局中间件" class="header-anchor">#</a> ④ 定义多个全局中间件</h4> <p>可以使用 app.use() 连续定义多个全局中间件。客户端请求到达服务器之后，会按照中间件定义的先后顺序依次进行调用。</p> <h4 id="_5-局部生效的中间件"><a href="#_5-局部生效的中间件" class="header-anchor">#</a> ⑤ <strong>局部生效</strong>的中间件</h4> <p><strong>不使用</strong> app.use() 定义的中间件，叫做局部生效的中间件，示例代码如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 定义中间件函数</span>
<span class="token keyword">const</span> <span class="token function-variable function">mw1</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'这是个中间件函数'</span><span class="token punctuation">)</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 局部使用的中间件</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> mw1<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Home Page.'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="_6-定义多个局部中间件"><a href="#_6-定义多个局部中间件" class="header-anchor">#</a> ⑥ 定义多个局部中间件</h4> <p>可以在路由中，通过如下两种等价的方式，使用多个局部中间件：（从前往后）</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> mw1<span class="token punctuation">,</span> mw2<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Home Page.'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>mw1<span class="token punctuation">,</span> mw2<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Home Page.'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="_7-中间件的注意事项"><a href="#_7-中间件的注意事项" class="header-anchor">#</a> ⑦ 中间件的注意事项</h4> <ul><li>一定要在<strong>路由之前</strong>注册中间件</li> <li>客户端发送过来的请求，可以连续调用多个中间件进行处理</li> <li>执行完中间件的业务代码之后，<strong>不要忘记调用 next() 函数</strong></li> <li>为了防止代码逻辑混乱，调用 next() 函数后不要再写额外的代码</li> <li>连续调用多个中间件时，多个中间件之间，<strong>共享 req 和 res 对象</strong></li></ul> <h3 id="_5-4-中间件的分类"><a href="#_5-4-中间件的分类" class="header-anchor">#</a> 5.4 中间件的分类</h3> <p>Express 官方把常见的中间件用法，分成了 5 大类，分别是：</p> <ul><li>应用级别的中间件</li> <li>路由级别的中间件</li> <li>错误级别的中间件</li> <li>Express 内置的中间件</li> <li>第三方的中间件</li></ul> <ol><li><p><strong>应用级别的中间件</strong></p> <p>通过 <code>app.use()</code> 或 <code>app.get()</code> 或 <code>app.post()</code> ，绑定到 app 实例上的中间件，叫做应用级别的中间件</p></li> <li><p><strong>路由级别的中间件</strong></p> <p>绑定到 express.Router() 实例上的中间件，叫做路由级别的中间件。它的用法和应用级别中间件没有任何区别。</p> <p>只不过，应用级别中间件是绑定到 <strong>app实例</strong>上，路由级别中间件绑定到 <strong>router实例</strong>上。</p></li> <li><p><strong>错误级别的中间件</strong></p> <p>错误级别中间件的<strong>作用</strong>：专门用来捕获整个项目中发生的异常错误，从而防止项目异常崩溃的问题。</p> <p><strong>格式</strong>：错误级别中间件的 function 处理函数中，必须有 4 个形参，形参顺序从前到后，分别是 (<strong>err</strong>, req, res, next)。</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'服务器内部发生了错误！'</span><span class="token punctuation">)</span>
  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Home Page.'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 定义错误级别的中间件，捕获整个项目的异常错误，从而防止程序崩溃</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'发送了错误：'</span> <span class="token operator">+</span> err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Error:'</span> <span class="token operator">+</span> err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p>**注意：**错误级别的中间件，必须注册在所有路由之后！</p></blockquote></li> <li><p><strong>Express 内置的中间件</strong></p> <p>自 Express 4.16.0 版本开始，Express 内置了 3 个常用的中间件，极大的提高了 Express 项目的开发效率和体验：</p> <ul><li><p><strong><code>express.static</code></strong> 快速托管静态资源的内置中间件，例如： HTML 文件、图片、CSS 样式等（无兼容性）</p></li> <li><p><strong><code>express.json</code></strong> 解析 <u>JSON 格式</u>的请求体数据（有兼容性，仅在 4.16.0+ 版本中可用）</p> <div class="language- extra-class"><pre class="language-text"><code>app.use(express.json())
</code></pre></div></li> <li><p><strong><code>express.urlencoded</code></strong> 解析 <u>URL-encoded 格式</u>的请求体数据（有兼容性，仅在 4.16.0+ 版本中可用）</p> <div class="language- extra-class"><pre class="language-text"><code>app.use(express.urlencoded({ extended: false }))
</code></pre></div></li></ul> <blockquote><p>使用 <strong><code>req.body</code></strong> 来获取 JSON 格式和 url-encoded 格式的数据，如果没有配置任何解析表单数据的中间件，则 req.body 默认等于 <code>undefined</code></p></blockquote></li> <li><p><strong>第三方的中间件</strong></p> <p>非 Express 官方内置的，而是由第三方开发出来的中间件，叫做第三方中间件。</p> <p>例如：在 express@4.16.0 之前的版本中，经常使用 body-parser 这个第三方中间件，来解析请求体数据。使用步骤如下：</p> <ul><li>运行 npm install body-parser 安装中间件</li> <li>使用 require 导入中间件</li> <li>调用 app.use() 注册并使用中间件</li></ul> <p>**注意：**Express 内置的 express.urlencoded 中间件，就是基于 body-parser 这个第三方中间件进一步封装出来的。</p></li></ol> <h3 id="_5-5-自定义中间件"><a href="#_5-5-自定义中间件" class="header-anchor">#</a> 5.5 自定义中间件</h3> <ol><li><p>需求描述与实现步骤</p> <p>手动模拟一个类似于 <code>express.urlencoded</code> 这样的中间件，来解析 POST 提交到服务器的表单数据。</p> <p>实现步骤：</p> <ul><li>定义中间件</li> <li>监听 req 的 data 事件</li> <li>监听 req 的 end 事件</li> <li>使用 querystring 模块解析请求体数据</li> <li>将解析出来的数据对象挂载为 req.body</li> <li>将自定义中间件封装为模块</li></ul></li> <li><p>定义中间件</p> <p>使用 app.use() 来定义全局生效的中间件，代码如下：</p> <div class="language-js extra-class"><pre class="language-js"><code>qpp<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 中间件的业务逻辑</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>监听 req 的 data 事件</p> <p>在中间件中，需要监听 req 对象的 <strong><code>data 事件</code></strong>，来<u>获取客户端发送到服务器的数据</u>。</p> <p>如果数据量比较大，无法一次性发送完毕，则客户端会把数据切割后，分批发送到服务器。所以 data 事件可能会触发多次，每一次触发 data 事件时，获取到数据只是完整数据的一部分，需要手动对接收到的数据进行拼接。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 定义变量，用来储存客户端发送过来的请求体数据</span>
<span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">''</span>
<span class="token comment">// 监听req对象的data事件（客户端发送过来的新的请求体数据）</span>
req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 拼接请求体数据，隐式转换为字符串</span>
  str <span class="token operator">+=</span> chunk
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>监听 req 的 end 事件</p> <p>当请求体数据接收完毕之后，会自动触发 req 的 <strong><code>end 事件</code></strong>。</p> <p>因此，我们可以在 req 的 end 事件中，拿到并处理完整的请求体数据。示例代码如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 监听req对象的end事件（请求体发送完毕后自动触发）</span>
req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 打印完整的请求体数据</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
  <span class="token comment">// 接下来需要：把字符串格式的请求体数据，解析成对象格式</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>使用 querystring 模块解析请求体数据</p> <p>Node.js 内置了一个 <strong><code>querystring 模块</code></strong>，专门<u>用来处理查询字符串</u>。通过这个模块提供的 parse() 函数，可以把查询字符串，解析成对象的格式。示例代码如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 导入querystring模块</span>
<span class="token keyword">const</span> qs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'querystring'</span><span class="token punctuation">)</span>
<span class="token comment">// 调用 qs.parse() 方法，把查询字符串解析为对象</span>
<span class="token keyword">const</span> body <span class="token operator">=</span> qs<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
</code></pre></div></li> <li><p>将解析出来的数据对象挂载为 req.body</p> <p>上游的中间件和下游的中间件及路由之间，<strong>共享同一份 req 和 res</strong>。因此，我们可以将解析出来的数据，挂载为 req 的自定义属性，命名为 req.body，供下游使用。示例代码如下：</p> <div class="language-js extra-class"><pre class="language-js"><code>req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> body <span class="token operator">=</span> qs<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
  req<span class="token punctuation">.</span>body <span class="token operator">=</span> body   <span class="token comment">// 将解析出来的请求体对象，挂载为 req.body 属性</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>将自定义中间件封装为模块</p> <p>为了优化代码的结构，可以把自定义的中间件函数，封装为独立的模块，示例代码如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> qs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'querystring'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> bodyParaser <span class="token operator">=</span> <span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* 中间件功能代码 */</span> <span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> bodyParaser <span class="token comment">// 导出中间件函数</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1. 导入自定义中间件模块</span>
<span class="token keyword">const</span> myBodyParaser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./body-parser.js'</span><span class="token punctuation">)</span>
<span class="token comment">// 2. 注册自定义的中间件模块</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>myBodyParser<span class="token punctuation">)</span>
</code></pre></div></li></ol> <h2 id="_6-使用-express-写接口"><a href="#_6-使用-express-写接口" class="header-anchor">#</a> 6. 使用 Express 写接口</h2> <h3 id="_6-1-创建基本的服务器"><a href="#_6-1-创建基本的服务器" class="header-anchor">#</a> 6.1 创建基本的服务器</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> port <span class="token operator">=</span> <span class="token number">3000</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Example app listening on port </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_6-2-创建-api-路由模块"><a href="#_6-2-创建-api-路由模块" class="header-anchor">#</a> 6.2 创建 API 路由模块</h3> <p>路由模块(apiRouter.js):</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> apiRouter <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">/* 
  模块功能代码:
  GET接口、POST接口等等
*/</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> apiRouter
</code></pre></div><p>app.js 中导入并注册路由模块:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> apiRouter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./apiRouter.js'</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/api'</span><span class="token punctuation">,</span> apiRouter<span class="token punctuation">)</span>
</code></pre></div><h3 id="_6-3-编写-get-接口"><a href="#_6-3-编写-get-接口" class="header-anchor">#</a> 6.3 编写 GET 接口</h3> <p>通过<strong>查询字符串</strong>请求数据，<code>req.query</code></p> <div class="language-js extra-class"><pre class="language-js"><code>apiRouter<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/get'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 获取客户端通过查询字符串，发送到服务器的数据</span>
  <span class="token keyword">const</span> query <span class="token operator">=</span> req<span class="token punctuation">.</span>query
  <span class="token comment">// 把数据响应给客户端</span>
  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    status<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>              <span class="token comment">// 状态码</span>
    msg<span class="token operator">:</span> <span class="token string">'GET请求成功！'</span><span class="token punctuation">,</span>    <span class="token comment">// 状态描述</span>
    data<span class="token operator">:</span> query             <span class="token comment">// 需要响应给客户端的具体数据</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_6-4-编写-post-接口"><a href="#_6-4-编写-post-接口" class="header-anchor">#</a> 6.4 编写 POST 接口</h3> <p>通过<strong>请求体</strong>请求数据，<code>req.body</code></p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span> extended<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

apiRouter<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/get'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 获取客户端通过请求体，发送到服务器的 URL-encoded 数据</span>
  <span class="token keyword">const</span> body <span class="token operator">=</span> req<span class="token punctuation">.</span>body
  <span class="token comment">// 把数据响应给客户端</span>
  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    status<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>              <span class="token comment">// 状态码</span>
    msg<span class="token operator">:</span> <span class="token string">'POST请求成功！'</span><span class="token punctuation">,</span>    <span class="token comment">// 状态描述</span>
    data<span class="token operator">:</span> body             <span class="token comment">// 需要响应给客户端的具体数据</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>注意：如果要获取 <strong><code>URL-encoded</code> 格式</strong>的请求体数据，必须配置中间件 <code>app.use(express.urlencoded({ extended: false }))</code></p> <h3 id="_6-5-cors-跨域资源共享"><a href="#_6-5-cors-跨域资源共享" class="header-anchor">#</a> 6.5 CORS 跨域资源共享</h3> <ol><li><p>接口的跨域问题</p> <p>我们通常所说的跨域是由浏览器<strong>同源策略限制</strong>的一类请求场景。</p> <blockquote><p>同源策略/SOP（Same origin policy）是一种约定，由Netscape公司1995年引入浏览器，它是浏览器最核心也最基本的安全功能，如果缺少了同源策略，浏览器很容易受到XSS、CSFR等攻击。所谓同源是指&quot;协议+域名+端口&quot;三者相同，即便两个不同的域名指向同一个ip地址，也非同源。</p></blockquote> <p>解决方案主要有两种:</p> <ul><li>CORS（主流的解决方案，推荐使用）</li> <li>JSONP（有缺陷的解决方案：只支持 GET 请求）</li></ul></li> <li><p>使用 <strong>cors 中间件</strong>解决跨域问题</p> <p>cors 是 Express 的一个第三方中间件。通过安装和配置 cors 中间件，可以很方便地解决跨域问题。</p> <p>使用步骤：</p> <ul><li>运行 <code>npm install cors</code> 安装中间件</li> <li>使用 <code>const cors = require('cors')</code> 导入中间件</li> <li>在<strong>路由之前</strong>调用 <code>app.use(cors())</code> 配置中间件</li></ul></li> <li><p>什么是 CORS</p> <p>CORS （Cross-Origin Resource Sharing，跨域资源共享）由一系列 HTTP 响应头组成，<strong>这些 HTTP 响应头决定浏览器是否阻止前端 JS 代码跨域获取资源</strong>。</p> <p>浏览器的<strong>同源安全策略</strong>默认会阻止网页“跨域”获取资源。但如果接口服务器配置了 CORS 相关的 <strong>HTTP 响应头</strong>，就可以解除浏览器端的跨域访问限制。</p> <p><img src="/assets/img/CORS.55b9f9f2.png" alt=""></p></li> <li><p>CORS 的注意事项</p> <ul><li>CORS 主要在<strong>服务器端</strong>进行配置。客户端浏览器<strong>无须做任何额外的配置</strong>，即可请求开启了 CORS 的接口。</li> <li>CORS 在浏览器中有兼容性。只有支持 XMLHttpRequest Level2 的浏览器，才能正常访问开启了 CORS 的服务端接口（例如：IE10+、Chrome4+、FireFox3.5+）。</li></ul></li> <li><p>CORS 配置的响应头</p> <p><strong>①  Access-Control-Allow-Origin</strong></p> <p>响应头部中可以携带一个 <strong>Access-Control-Allow-Origin</strong> 字段，其语法如下:</p> <div class="language-js extra-class"><pre class="language-js"><code>Access<span class="token operator">-</span>Control<span class="token operator">-</span>Allow<span class="token operator">-</span>Origin<span class="token operator">:</span> <span class="token operator">&lt;</span>origin<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token operator">*</span>
</code></pre></div><p>其中，origin 参数的值指定了允许访问该资源的外域 URL。</p> <p>例如，下面的字段值将<strong>只允许</strong>来自 http://baidu.com 的请求：</p> <div class="language-js extra-class"><pre class="language-js"><code>res<span class="token punctuation">.</span><span class="token function">sertHeader</span><span class="token punctuation">(</span><span class="token string">'Access-Control-Allow-Origin'</span><span class="token punctuation">,</span> <span class="token string">'http://baidu.com'</span><span class="token punctuation">)</span>
</code></pre></div><p>如果指定了 Access-Control-Allow-Origin 字段的值为通配符 *****，表示允许来自任何域的请求：</p> <div class="language-js extra-class"><pre class="language-js"><code>res<span class="token punctuation">.</span><span class="token function">sertHeader</span><span class="token punctuation">(</span><span class="token string">'Access-Control-Allow-Origin'</span><span class="token punctuation">,</span> <span class="token string">'*'</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>② Access-Control-Allow-Headers</strong></p> <p>默认情况下，CORS <strong>仅</strong>支持客户端向服务器发送如下的 9 个请求头：</p> <p>Accept、Accept-Language、Content-Language、DPR、Downlink、Save-Data、Viewport-Width、Width 、Content-Type （值仅限于 text/plain、multipart/form-data、application/x-www-form-urlencoded 三者之一）</p> <p>如果客户端向服务器发送了额外的请求头信息，则需要在服务器端，通过 Access-Control-Allow-Headers 对额外的请求头进行声明，否则这次请求会失败！</p> <p><strong>③ Access-Control-Allow-Methods</strong></p> <p>默认情况下，CORS 仅支持客户端发起 <u>GET、POST、HEAD</u> 请求。</p> <p>如果客户端希望通过 <u><strong>PUT、DELETE</strong></u> 等方式请求服务器的资源，则需要在服务器端，通过 Access-Control-Alow-Methods来指明实际请求所允许使用的 HTTP 方法。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 只允许 POST、GET、DELETE、HEAD 请求方法</span>
res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Access-Control-Allow-Methods'</span><span class="token punctuation">,</span> <span class="token string">'POST, GET, DELETE, HEAD'</span><span class="token punctuation">)</span>
<span class="token comment">// 允许所有的HTTP请求方法</span>
res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Access-Control-Allow-Methods'</span><span class="token punctuation">,</span> <span class="token string">'*'</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>CORS请求的分类</p> <p>客户端在请求 CORS 接口时，根据请求方式和请求头的不同，可以将 CORS 的请求分为两大类，分别是：简单请求和预检请求。</p> <p><strong>① 简单请求</strong></p> <p>同时满足以下两大条件的请求，就属于简单请求：</p> <ul><li><u>请求方式</u>：GET、POST、HEAD 三者之一</li> <li><u>HTTP 头部信息</u>不超过以下几种字段：无自定义头部字段、Accept、Accept-Language、Content-Language、DPR、Downlink、Save-Data、Viewport-Width、Width 、Content-Type（只有三个值application/x-www-form-urlencoded、multipart/form-data、text/plain）</li></ul> <p><strong>② 预检请求</strong></p> <p>只要符合以下任何一个条件的请求，都需要进行预检请求：</p> <ul><li>请求方式为 GET、POST、HEAD <strong>之外</strong>的请求 Method 类型</li> <li>请求头中包含自定义头部字段</li> <li>向服务器发送了 <u>application/json</u> 格式的数据</li></ul> <p>在浏览器与服务器正式通信之前，浏览器会<u>先发送 OPTION 请求进行预检</u>，以获知服务器是否允许该实际请求，所以这一次的 OPTION 请求称为“预检请求”。服务器成功响应预检请求后，才会发送真正的请求，并且携带真实数据。</p> <p><strong>③ 简单请求和预检请求的区别</strong></p> <p><strong>简单请求的特点</strong>：客户端与服务器之间只会发生一次请求。</p> <p><strong>预检请求的特点</strong>：客户端与服务器之间会发生两次请求，OPTION 预检请求成功之后，才会发起真正的请求。</p></li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/nodejs/4.模块化.html" class="prev">
        四、模块化
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.61103f05.js" defer></script><script src="/assets/js/3.5422f50d.js" defer></script><script src="/assets/js/5.0bdab4d0.js" defer></script>
  </body>
</html>
