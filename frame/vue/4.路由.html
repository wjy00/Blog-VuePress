<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>四、路由 | Blog-WJY</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="WJY-Blog">
    
    <link rel="preload" href="/assets/css/0.styles.35bcedcf.css" as="style"><link rel="preload" href="/assets/js/app.61103f05.js" as="script"><link rel="preload" href="/assets/js/3.5422f50d.js" as="script"><link rel="preload" href="/assets/js/40.f6c77657.js" as="script"><link rel="prefetch" href="/assets/js/10.48398857.js"><link rel="prefetch" href="/assets/js/11.8b41c02f.js"><link rel="prefetch" href="/assets/js/12.b43b0fa5.js"><link rel="prefetch" href="/assets/js/13.8ebb1414.js"><link rel="prefetch" href="/assets/js/14.c83413f7.js"><link rel="prefetch" href="/assets/js/15.6112a6db.js"><link rel="prefetch" href="/assets/js/16.9821c622.js"><link rel="prefetch" href="/assets/js/17.24637ad6.js"><link rel="prefetch" href="/assets/js/18.ba05d0f7.js"><link rel="prefetch" href="/assets/js/19.398c37df.js"><link rel="prefetch" href="/assets/js/2.a5f5b41e.js"><link rel="prefetch" href="/assets/js/20.6175dbef.js"><link rel="prefetch" href="/assets/js/21.271e947a.js"><link rel="prefetch" href="/assets/js/22.b544afc3.js"><link rel="prefetch" href="/assets/js/23.3085b46b.js"><link rel="prefetch" href="/assets/js/24.f608e65b.js"><link rel="prefetch" href="/assets/js/25.64e77ea9.js"><link rel="prefetch" href="/assets/js/26.a6095427.js"><link rel="prefetch" href="/assets/js/27.aa814ee5.js"><link rel="prefetch" href="/assets/js/28.92fc9274.js"><link rel="prefetch" href="/assets/js/29.8689cd3d.js"><link rel="prefetch" href="/assets/js/30.8a913ce1.js"><link rel="prefetch" href="/assets/js/31.74c17c5a.js"><link rel="prefetch" href="/assets/js/32.a433e998.js"><link rel="prefetch" href="/assets/js/33.92f32f1c.js"><link rel="prefetch" href="/assets/js/34.6d1e7a32.js"><link rel="prefetch" href="/assets/js/35.b453475a.js"><link rel="prefetch" href="/assets/js/36.c22e7750.js"><link rel="prefetch" href="/assets/js/37.6c33872a.js"><link rel="prefetch" href="/assets/js/38.193c163f.js"><link rel="prefetch" href="/assets/js/39.ab325b65.js"><link rel="prefetch" href="/assets/js/4.594b49aa.js"><link rel="prefetch" href="/assets/js/41.99108772.js"><link rel="prefetch" href="/assets/js/42.729c9018.js"><link rel="prefetch" href="/assets/js/43.96c9b404.js"><link rel="prefetch" href="/assets/js/44.40e1b3eb.js"><link rel="prefetch" href="/assets/js/45.49720d5f.js"><link rel="prefetch" href="/assets/js/46.ee580737.js"><link rel="prefetch" href="/assets/js/47.de619698.js"><link rel="prefetch" href="/assets/js/48.e1a28b55.js"><link rel="prefetch" href="/assets/js/49.0bc2c3f6.js"><link rel="prefetch" href="/assets/js/5.0bdab4d0.js"><link rel="prefetch" href="/assets/js/50.180a5c62.js"><link rel="prefetch" href="/assets/js/51.6442c9c7.js"><link rel="prefetch" href="/assets/js/52.d65d7ff2.js"><link rel="prefetch" href="/assets/js/53.cabe401d.js"><link rel="prefetch" href="/assets/js/54.373c862c.js"><link rel="prefetch" href="/assets/js/55.48b13b1b.js"><link rel="prefetch" href="/assets/js/56.6e6b6725.js"><link rel="prefetch" href="/assets/js/57.41b3d131.js"><link rel="prefetch" href="/assets/js/58.6bd80af7.js"><link rel="prefetch" href="/assets/js/59.ab0b7ffc.js"><link rel="prefetch" href="/assets/js/6.0b7e2305.js"><link rel="prefetch" href="/assets/js/60.bd8bace5.js"><link rel="prefetch" href="/assets/js/61.07fc73df.js"><link rel="prefetch" href="/assets/js/7.81f0a449.js"><link rel="prefetch" href="/assets/js/8.880736f4.js"><link rel="prefetch" href="/assets/js/9.36b50a9e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.35bcedcf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/img/logo.png" alt="Blog-WJY" class="logo"> <span class="site-name can-hide">Blog-WJY</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  🏠 主页
</a></div><div class="nav-item"><a href="/about.html" class="nav-link">
  💗 关于
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="计算机基础" class="mobile-dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/computer/sa/" class="nav-link">
  数据结构与算法
</a></li><li class="dropdown-item"><!----> <a href="/computer/np/" class="nav-link">
  计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/computer/os/" class="nav-link">
  操作系统
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="HTML+CSS" class="dropdown-title"><span class="title">HTML+CSS</span> <span class="arrow down"></span></button> <button type="button" aria-label="HTML+CSS" class="mobile-dropdown-title"><span class="title">HTML+CSS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/htmlcss/html/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/htmlcss/css/" class="nav-link">
  CSS
</a></li></ul></div></div><div class="nav-item"><a href="/javascript/" class="nav-link">
  JavaScript
</a></div><div class="nav-item"><a href="/nodejs/" class="nav-link">
  Node.js
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端框架" class="dropdown-title"><span class="title">前端框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端框架" class="mobile-dropdown-title"><span class="title">前端框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frame/vue/" class="nav-link router-link-active">
  vue
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他知识" class="dropdown-title"><span class="title">其他知识</span> <span class="arrow down"></span></button> <button type="button" aria-label="其他知识" class="mobile-dropdown-title"><span class="title">其他知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/others/git/" class="nav-link">
  GIT
</a></li><li class="dropdown-item"><!----> <a href="/others/webpack/" class="nav-link">
  WEBPACK
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="⭐ 项目" class="dropdown-title"><span class="title">⭐ 项目</span> <span class="arrow down"></span></button> <button type="button" aria-label="⭐ 项目" class="mobile-dropdown-title"><span class="title">⭐ 项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="http://demo.wjy00.top:8899/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后台管理系统项目
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://demo.wjy00.top:8888/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  echart监控系统项目
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="/interview/" class="nav-link">
  💬 面经
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  🏠 主页
</a></div><div class="nav-item"><a href="/about.html" class="nav-link">
  💗 关于
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="计算机基础" class="mobile-dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/computer/sa/" class="nav-link">
  数据结构与算法
</a></li><li class="dropdown-item"><!----> <a href="/computer/np/" class="nav-link">
  计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/computer/os/" class="nav-link">
  操作系统
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="HTML+CSS" class="dropdown-title"><span class="title">HTML+CSS</span> <span class="arrow down"></span></button> <button type="button" aria-label="HTML+CSS" class="mobile-dropdown-title"><span class="title">HTML+CSS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/htmlcss/html/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/htmlcss/css/" class="nav-link">
  CSS
</a></li></ul></div></div><div class="nav-item"><a href="/javascript/" class="nav-link">
  JavaScript
</a></div><div class="nav-item"><a href="/nodejs/" class="nav-link">
  Node.js
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端框架" class="dropdown-title"><span class="title">前端框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端框架" class="mobile-dropdown-title"><span class="title">前端框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frame/vue/" class="nav-link router-link-active">
  vue
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他知识" class="dropdown-title"><span class="title">其他知识</span> <span class="arrow down"></span></button> <button type="button" aria-label="其他知识" class="mobile-dropdown-title"><span class="title">其他知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/others/git/" class="nav-link">
  GIT
</a></li><li class="dropdown-item"><!----> <a href="/others/webpack/" class="nav-link">
  WEBPACK
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="⭐ 项目" class="dropdown-title"><span class="title">⭐ 项目</span> <span class="arrow down"></span></button> <button type="button" aria-label="⭐ 项目" class="mobile-dropdown-title"><span class="title">⭐ 项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="http://demo.wjy00.top:8899/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后台管理系统项目
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://demo.wjy00.top:8888/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  echart监控系统项目
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="/interview/" class="nav-link">
  💬 面经
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>VUE</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/frame/vue/" aria-current="page" class="sidebar-link">Vue 面试题常见问题</a></li><li><a href="/frame/vue/1.Vue基础.html" class="sidebar-link">一、Vue 基础</a></li><li><a href="/frame/vue/2.生命周期.html" class="sidebar-link">二、生命周期</a></li><li><a href="/frame/vue/3.组件通信.html" class="sidebar-link">三、组件通信</a></li><li><a href="/frame/vue/4.路由.html" class="active sidebar-link">四、路由</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/frame/vue/4.路由.html#_1-vue-router-的懒加载如何实现" class="sidebar-link">1. Vue-Router 的懒加载如何实现</a></li><li class="sidebar-sub-header"><a href="/frame/vue/4.路由.html#_2-路由的hash和history模式的区别" class="sidebar-link">2. 路由的hash和history模式的区别</a></li><li class="sidebar-sub-header"><a href="/frame/vue/4.路由.html#_1-hash模式" class="sidebar-link">1. hash模式</a></li><li class="sidebar-sub-header"><a href="/frame/vue/4.路由.html#_2-history模式" class="sidebar-link">2. history模式</a></li><li class="sidebar-sub-header"><a href="/frame/vue/4.路由.html#_3-两种模式对比" class="sidebar-link">3. 两种模式对比</a></li><li class="sidebar-sub-header"><a href="/frame/vue/4.路由.html#_3-如何获取页面的hash变化" class="sidebar-link">3. 如何获取页面的hash变化</a></li><li class="sidebar-sub-header"><a href="/frame/vue/4.路由.html#_4-route-和-router-的区别" class="sidebar-link">4. $route 和$router 的区别</a></li><li class="sidebar-sub-header"><a href="/frame/vue/4.路由.html#_5-如何定义动态路由-如何获取传过来的动态参数" class="sidebar-link">5. 如何定义动态路由？如何获取传过来的动态参数？</a></li><li class="sidebar-sub-header"><a href="/frame/vue/4.路由.html#_6-vue-router-路由钩子在生命周期的体现" class="sidebar-link">6. Vue-router 路由钩子在生命周期的体现</a></li><li class="sidebar-sub-header"><a href="/frame/vue/4.路由.html#_7-vue-router跳转和location-href有什么区别" class="sidebar-link">7. Vue-router跳转和location.href有什么区别</a></li><li class="sidebar-sub-header"><a href="/frame/vue/4.路由.html#_8-params和query的区别" class="sidebar-link">8. params和query的区别</a></li><li class="sidebar-sub-header"><a href="/frame/vue/4.路由.html#_9-vue-router-导航守卫有哪些" class="sidebar-link">9. Vue-router 导航守卫有哪些</a></li><li class="sidebar-sub-header"><a href="/frame/vue/4.路由.html#_10-对前端路由的理解" class="sidebar-link">10. 对前端路由的理解</a></li></ul></li><li><a href="/frame/vue/5.VueX.html" class="sidebar-link">五、Vuex</a></li><li><a href="/frame/vue/6.Vue 3.0.html" class="sidebar-link">六、Vue 3.0</a></li><li><a href="/frame/vue/7.虚拟DOM.html" class="sidebar-link">七、虚拟DOM</a></li><li><a href="/frame/vue/8.Vue项目的性能优化.html" class="sidebar-link">Vue 项目的性能优化</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="四、路由"><a href="#四、路由" class="header-anchor">#</a> 四、路由</h1> <h2 id="_1-vue-router-的懒加载如何实现"><a href="#_1-vue-router-的懒加载如何实现" class="header-anchor">#</a> 1. Vue-Router 的懒加载如何实现</h2> <p>非懒加载：</p> <div class="language- extra-class"><pre class="language-text"><code>import List from '@/components/list.vue'
const router = new VueRouter({
  routes: [
    { path: '/list', component: List }
  ]
})
</code></pre></div><p>（1）方案一(常用)：使用箭头函数+import动态加载</p> <div class="language- extra-class"><pre class="language-text"><code>const List = () =&gt; import('@/components/list.vue')
const router = new VueRouter({
  routes: [
    { path: '/list', component: List }
  ]
})
</code></pre></div><p>（2）方案二：使用箭头函数+require动态加载</p> <div class="language- extra-class"><pre class="language-text"><code>const router = new Router({
  routes: [
   {
     path: '/list',
     component: resolve =&gt; require(['@/components/list'], resolve)
   }
  ]
})
</code></pre></div><p>（3）方案三：使用webpack的require.ensure技术，也可以实现按需加载。 这种情况下，多个路由指定相同的chunkName，会合并打包成一个js文件。</p> <div class="language- extra-class"><pre class="language-text"><code>// r就是resolve
const List = r =&gt; require.ensure([], () =&gt; r(require('@/components/list')), 'list');
// 路由也是正常的写法  这种是官方推荐的写的 按模块划分懒加载 
const router = new Router({
  routes: [
  {
    path: '/list',
    component: List,
    name: 'list'
  }
 ]
}))
</code></pre></div><h2 id="_2-路由的hash和history模式的区别"><a href="#_2-路由的hash和history模式的区别" class="header-anchor">#</a> 2. 路由的hash和history模式的区别</h2> <p>Vue-Router有两种模式：<strong>hash模式</strong>和<strong>history模式</strong>。默认的路由模式是hash模式。</p> <h2 id="_1-hash模式"><a href="#_1-hash模式" class="header-anchor">#</a> 1. hash模式</h2> <p><strong>简介：</strong> hash模式是开发中默认的模式，它的URL带着一个#，例如：http://www.abc.com/#/vue，它的hash值就是<code>#/vue</code>。</p> <p><strong>特点</strong>：hash值会出现在URL里面，但是不会出现在HTTP请求中，对后端完全没有影响。所以改变hash值，不会重新加载页面。这种模式的浏览器支持度很好，低版本的IE浏览器也支持这种模式。hash路由被称为是前端路由，已经成为SPA（单页面应用）的标配。</p> <p><strong>原理：</strong> hash模式的主要原理就是<strong>onhashchange()事件</strong>：</p> <div class="language- extra-class"><pre class="language-text"><code>window.onhashchange = function(event){
    console.log(event.oldURL, event.newURL);
    let hash = location.hash.slice(1);
}
</code></pre></div><p>使用onhashchange()事件的好处就是，在页面的hash值发生变化时，无需向后端发起请求，window就可以监听事件的改变，并按规则加载相应的代码。除此之外，hash值变化对应的URL都会被浏览器记录下来，这样浏览器就能实现页面的前进和后退。虽然是没有请求后端服务器，但是页面的hash值和对应的URL关联起来了。</p> <h2 id="_2-history模式"><a href="#_2-history模式" class="header-anchor">#</a> 2. history模式</h2> <p><strong>简介：</strong> history模式的URL中没有#，它使用的是传统的路由分发模式，即用户在输入一个URL时，服务器会接收这个请求，并解析这个URL，然后做出相应的逻辑处理。</p> <p><strong>特点：</strong> 当使用history模式时，URL就像这样：http://abc.com/user/id。相比hash模式更加好看。但是，history模式需要后台配置支持。如果后台没有正确配置，访问时会返回404。</p> <p><strong>API：</strong> history api可以分为两大部分，切换历史状态和修改历史状态：</p> <ul><li><strong>修改历史状态</strong>：包括了 HTML5 History Interface 中新增的 <code>pushState()</code> 和 <code>replaceState()</code> 方法，这两个方法应用于浏览器的历史记录栈，提供了对历史记录进行修改的功能。只是当他们进行修改时，虽然修改了url，但浏览器不会立即向后端发送请求。如果要做到改变url但又不刷新页面的效果，就需要前端用上这两个API。</li> <li><strong>切换历史状态：</strong> 包括<code>forward()</code>、<code>back()</code>、<code>go()</code>三个方法，对应浏览器的前进，后退，跳转操作。</li></ul> <p>虽然history模式丢弃了丑陋的#。但是，它也有自己的缺点，就是在刷新页面的时候，如果没有相应的路由或资源，就会刷出404来。</p> <p>如果想要切换到history模式，就要进行以下配置（后端也要进行配置）：</p> <div class="language- extra-class"><pre class="language-text"><code>const router = new VueRouter({
  mode: 'history',
  routes: [...]
})
</code></pre></div><h2 id="_3-两种模式对比"><a href="#_3-两种模式对比" class="header-anchor">#</a> 3. 两种模式对比</h2> <p>调用 history.pushState() 相比于直接修改 hash，存在以下优势:</p> <ul><li>pushState() 设置的新 URL 可以是与当前 URL 同源的任意 URL；而 hash 只可修改 # 后面的部分，因此只能设置与当前 URL 同文档的 URL；</li> <li>pushState() 设置的新 URL 可以与当前 URL 一模一样，这样也会把记录添加到栈中；而 hash 设置的新值必须与原来不一样才会触发动作将记录添加到栈中；</li> <li>pushState() 通过 stateObject 参数可以添加任意类型的数据到记录中；而 hash 只可添加短字符串；</li> <li>pushState() 可额外设置 title 属性供后续使用。</li> <li>hash模式下，仅hash符号之前的url会被包含在请求中，后端如果没有做到对路由的全覆盖，也不会返回404错误；history模式下，前端的url必须和实际向后端发起请求的url一致，如果没有对用的路由处理，将返回404错误。</li></ul> <p>hash模式和history模式都有各自的优势和缺陷，还是要根据实际情况选择性的使用。</p> <h2 id="_3-如何获取页面的hash变化"><a href="#_3-如何获取页面的hash变化" class="header-anchor">#</a> 3. 如何获取页面的hash变化</h2> <p><strong>（1）监听$route的变化</strong></p> <div class="language- extra-class"><pre class="language-text"><code>// 监听,当路由发生变化的时候执行
watch: {
  $route: {
    handler: function(val, oldVal){
      console.log(val);
    },
    // 深度观察监听
    deep: true
  }
},
</code></pre></div><p><strong>（2）window.location.hash读取#值</strong></p> <p>window.location.hash 的值可读可写，读取来判断状态是否改变，写入时可以在不重载网页的前提下，添加一条历史访问记录。</p> <h2 id="_4-route-和-router-的区别"><a href="#_4-route-和-router-的区别" class="header-anchor">#</a> 4. $route 和$router 的区别</h2> <ul><li>$route 是“路由信息对象”，包括 path，params，hash，query，fullPath，matched，name 等路由信息参数</li> <li>$router 是“路由实例”对象包括了路由的跳转方法，钩子函数等。</li></ul> <h2 id="_5-如何定义动态路由-如何获取传过来的动态参数"><a href="#_5-如何定义动态路由-如何获取传过来的动态参数" class="header-anchor">#</a> 5. 如何定义动态路由？如何获取传过来的动态参数？</h2> <p><strong>（1）param方式</strong></p> <ul><li>配置路由格式：<code>/router/:id</code></li> <li>传递的方式：在path后面跟上对应的值</li> <li>传递后形成的路径：<code>/router/123</code></li></ul> <p>1）路由定义</p> <div class="language- extra-class"><pre class="language-text"><code>//在APP.vue中
&lt;router-link :to=&quot;'/user/'+userId&quot; replace&gt;用户&lt;/router-link&gt;    

//在index.js
{
   path: '/user/:userid',
   component: User,
},
</code></pre></div><p>2）路由跳转</p> <div class="language- extra-class"><pre class="language-text"><code>// 方法1：
&lt;router-link :to=&quot;{ name: 'users', params: { uname: wade }}&quot;&gt;按钮&lt;/router-link

// 方法2：
this.$router.push({name:'users',params:{uname:wade}})

// 方法3：
this.$router.push('/user/' + wade)
</code></pre></div><p>3）参数获取</p> <p>通过 <code>$route.params.userid</code> 获取传递的值</p> <p><strong>（2）query方式</strong></p> <ul><li>配置路由格式：<code>/router</code>，也就是普通配置</li> <li>传递的方式：对象中使用query的key作为传递方式</li> <li>传递后形成的路径：<code>/route?id=123</code></li></ul> <p>1）路由定义</p> <div class="language- extra-class"><pre class="language-text"><code>//方式1：直接在router-link 标签上以对象的形式
&lt;router-link :to=&quot;{path:'/profile',query:{name:'why',age:28,height:188}}&quot;&gt;档案&lt;/router-link&gt;

// 方式2：写成按钮以点击事件形式
&lt;button @click='profileClick'&gt;我的&lt;/button&gt;    

profileClick(){
  this.$router.push({
    path: &quot;/profile&quot;,
    query: {
        name: &quot;kobi&quot;,
        age: &quot;28&quot;,
        height: 198
    }
  });
}
</code></pre></div><p>2）跳转方法</p> <div class="language- extra-class"><pre class="language-text"><code>// 方法1：
&lt;router-link :to=&quot;{ name: 'users', query: { uname: james }}&quot;&gt;按钮&lt;/router-link&gt;

// 方法2：
this.$router.push({ name: 'users', query:{ uname:james }})

// 方法3：
&lt;router-link :to=&quot;{ path: '/user', query: { uname:james }}&quot;&gt;按钮&lt;/router-link&gt;

// 方法4：
this.$router.push({ path: '/user', query:{ uname:james }})

// 方法5：
this.$router.push('/user?uname=' + jsmes)
</code></pre></div><p>3）获取参数</p> <div class="language- extra-class"><pre class="language-text"><code>通过$route.query 获取传递的值
</code></pre></div><h2 id="_6-vue-router-路由钩子在生命周期的体现"><a href="#_6-vue-router-路由钩子在生命周期的体现" class="header-anchor">#</a> 6. Vue-router 路由钩子在生命周期的体现</h2> <p>一、Vue-Router导航守卫</p> <p>有的时候，需要通过路由来进行一些操作，比如最常见的登录权限验证，当用户满足条件时，才让其进入导航，否则就取消跳转，并跳到登录页面让其登录。</p> <p>为此有很多种方法可以植入路由的导航过程：全局的，单个路由独享的，或者组件级的</p> <ol><li>全局路由钩子</li></ol> <p>vue-router全局有三个路由钩子;</p> <ul><li>router.beforeEach 全局前置守卫 进入路由之前</li> <li>router.beforeResolve 全局解析守卫（2.5.0+）在 beforeRouteEnter 调用之后调用</li> <li>router.afterEach 全局后置钩子 进入路由之后</li></ul> <p>具体使用∶</p> <ul><li>beforeEach（判断是否登录了，没登录就跳转到登录页）</li></ul> <div class="language- extra-class"><pre class="language-text"><code>router.beforeEach((to, from, next) =&gt; {  
    let ifInfo = Vue.prototype.$common.getSession('userData');  // 判断是否登录的存储信息
    if (!ifInfo) { 
        // sessionStorage里没有储存user信息    
        if (to.path == '/') { 
            //如果是登录页面路径，就直接next()      
            next();    
        } else { 
            //不然就跳转到登录      
            Message.warning(&quot;请重新登录！&quot;);     
            window.location.href = Vue.prototype.$loginUrl;    
        }  
    } else {    
        return next();  
    }
})
</code></pre></div><ul><li>afterEach （跳转之后滚动条回到顶部）</li></ul> <div class="language- extra-class"><pre class="language-text"><code>router.afterEach((to, from) =&gt; {  
    // 跳转之后滚动条回到顶部  
    window.scrollTo(0,0);
});
</code></pre></div><ol><li>单个路由独享钩子</li></ol> <p><strong>beforeEnter</strong></p> <p>如果不想全局配置守卫的话，可以为某些路由单独配置守卫，有三个参数∶ to、from、next</p> <div class="language- extra-class"><pre class="language-text"><code>export default [    
    {        
        path: '/',        
        name: 'login',        
        component: login,        
        beforeEnter: (to, from, next) =&gt; {          
            console.log('即将进入登录页面')          
            next()        
        }    
    }
]
</code></pre></div><ol><li>组件内钩子</li></ol> <p>beforeRouteUpdate、beforeRouteEnter、beforeRouteLeave</p> <p>这三个钩子都有三个参数∶to、from、next</p> <ul><li>beforeRouteEnter∶ 进入组件前触发</li> <li>beforeRouteUpdate∶ 当前地址改变并且改组件被复用时触发，举例来说，带有动态参数的路径foo/∶id，在 /foo/1 和 /foo/2 之间跳转的时候，由于会渲染同样的foa组件，这个钩子在这种情况下就会被调用</li> <li>beforeRouteLeave∶ 离开组件被调用</li></ul> <p>注意点，beforeRouteEnter组件内还访问不到this，因为该守卫执行前组件实例还没有被创建，需要传一个回调给 next来访问，例如：</p> <div class="language- extra-class"><pre class="language-text"><code>beforeRouteEnter(to, from, next) {      
    next(target =&gt; {        
        if (from.path == '/classProcess') {          
            target.isFromProcess = true        
        }      
    })    
}
</code></pre></div><p>二、Vue路由钩子在生命周期函数的体现</p> <ol><li>完整的路由导航解析流程（不包括其他生命周期）</li></ol> <ul><li>触发进入其他路由。</li> <li>调用要离开路由的组件守卫beforeRouteLeave</li> <li>调用局前置守卫∶ beforeEach</li> <li>在重用的组件里调用 beforeRouteUpdate</li> <li>调用路由独享守卫 beforeEnter。</li> <li>解析异步路由组件。</li> <li>在将要进入的路由组件中调用 beforeRouteEnter</li> <li>调用全局解析守卫 beforeResolve</li> <li>导航被确认。</li> <li>调用全局后置钩子的 afterEach 钩子。</li> <li>触发DOM更新（mounted）。</li> <li>执行beforeRouteEnter 守卫中传给 next 的回调函数</li></ul> <ol><li>触发钩子的完整顺序</li></ol> <p>路由导航、keep-alive、和组件生命周期钩子结合起来的，触发顺序，假设是从a组件离开，第一次进入b组件∶</p> <ul><li>beforeRouteLeave：路由组件的组件离开路由前钩子，可取消路由离开。</li> <li>beforeEach：路由全局前置守卫，可用于登录验证、全局路由loading等。</li> <li>beforeEnter：路由独享守卫</li> <li>beforeRouteEnter：路由组件的组件进入路由前钩子。</li> <li>beforeResolve：路由全局解析守卫</li> <li>afterEach：路由全局后置钩子</li> <li>beforeCreate：组件生命周期，不能访问tAis。</li> <li>created;组件生命周期，可以访问tAis，不能访问dom。</li> <li>beforeMount：组件生命周期</li> <li>deactivated：离开缓存组件a，或者触发a的beforeDestroy和destroyed组件销毁钩子。</li> <li>mounted：访问/操作dom。</li> <li>activated：进入缓存组件，进入a的嵌套子组件（如果有的话）。</li> <li>执行beforeRouteEnter回调函数next。</li></ul> <ol><li>导航行为被触发到导航完成的整个过程</li></ol> <ul><li>导航行为被触发，此时导航未被确认。</li> <li>在失活的组件里调用离开守卫 beforeRouteLeave。</li> <li>调用全局的 beforeEach守卫。</li> <li>在重用的组件里调用 beforeRouteUpdate 守卫(2.2+)。</li> <li>在路由配置里调用 beforeEnteY。</li> <li>解析异步路由组件（如果有）。</li> <li>在被激活的组件里调用 beforeRouteEnter。</li> <li>调用全局的 beforeResolve 守卫（2.5+），标示解析阶段完成。</li> <li>导航被确认。</li> <li>调用全局的 afterEach 钩子。</li> <li>非重用组件，开始组件实例的生命周期：beforeCreate&amp;created、beforeMount&amp;mounted</li> <li>触发 DOM 更新。</li> <li>用创建好的实例调用 beforeRouteEnter守卫中传给 next 的回调函数。</li> <li>导航完成</li></ul> <h2 id="_7-vue-router跳转和location-href有什么区别"><a href="#_7-vue-router跳转和location-href有什么区别" class="header-anchor">#</a> 7. Vue-router跳转和location.href有什么区别</h2> <ul><li>使用 <code>location.href= /url</code>来跳转，简单方便，但是刷新了页面；</li> <li>使用 <code>history.pushState( /url )</code> ，无刷新页面，静态跳转；</li> <li>引进 router ，然后使用 <code>router.push( /url )</code> 来跳转，使用了 <code>diff</code> 算法，实现了按需加载，减少了 dom 的消耗。其实使用 router 跳转和使用 <code>history.pushState()</code> 没什么差别的，因为vue-router就是用了 <code>history.pushState()</code> ，尤其是在history模式下。</li></ul> <h2 id="_8-params和query的区别"><a href="#_8-params和query的区别" class="header-anchor">#</a> 8. params和query的区别</h2> <p><strong>用法</strong>：query要用path来引入，params要用name来引入，接收参数都是类似的，分别是 <code>this.$route.query.name</code> 和 <code>this.$route.params.name</code> 。</p> <p><strong>url地址显示</strong>：query更加类似于ajax中get传参，params则类似于post，说的再简单一点，前者在浏览器地址栏中显示参数，后者则不显示</p> <p><strong>注意</strong>：query刷新不会丢失query里面的数据 params刷新会丢失 params里面的数据。</p> <h2 id="_9-vue-router-导航守卫有哪些"><a href="#_9-vue-router-导航守卫有哪些" class="header-anchor">#</a> 9. Vue-router 导航守卫有哪些</h2> <ul><li>全局前置/钩子：beforeEach、beforeResolve、afterEach</li> <li>路由独享的守卫：beforeEnter</li> <li>组件内的守卫：beforeRouteEnter、beforeRouteUpdate、beforeRouteLeave</li></ul> <h2 id="_10-对前端路由的理解"><a href="#_10-对前端路由的理解" class="header-anchor">#</a> 10. 对前端路由的理解</h2> <p>在前端技术早期，一个 url 对应一个页面，如果要从 A 页面切换到 B 页面，那么必然伴随着页面的刷新。这个体验并不好，不过在最初也是无奈之举——用户只有在刷新页面的情况下，才可以重新去请求数据。</p> <p>后来，改变发生了——Ajax 出现了，它允许人们在不刷新页面的情况下发起请求；与之共生的，还有“不刷新页面即可更新页面内容”这种需求。在这样的背景下，出现了 <strong>SPA（单页面应用</strong>）。</p> <p>SPA极大地提升了用户体验，它允许页面在不刷新的情况下更新页面内容，使内容的切换更加流畅。但是在 SPA 诞生之初，人们并没有考虑到“定位”这个问题——在内容切换前后，页面的 URL 都是一样的，这就带来了两个问题：</p> <ul><li>SPA 其实并不知道当前的页面“进展到了哪一步”。可能在一个站点下经过了反复的“前进”才终于唤出了某一块内容，但是此时只要刷新一下页面，一切就会被清零，必须重复之前的操作、才可以重新对内容进行定位——SPA 并不会“记住”你的操作。</li> <li>由于有且仅有一个 URL 给页面做映射，这对 SEO 也不够友好，搜索引擎无法收集全面的信息</li></ul> <p>为了解决这个问题，前端路由出现了。</p> <p>前端路由可以帮助我们在仅有一个页面的情况下，“记住”用户当前走到了哪一步——为 SPA 中的各个视图匹配一个唯一标识。这意味着用户前进、后退触发的新内容，都会映射到不同的 URL 上去。此时即便他刷新页面，因为当前的 URL 可以标识出他所处的位置，因此内容也不会丢失。</p> <p>那么如何实现这个目的呢？首先要解决两个问题：</p> <ul><li>当用户刷新页面时，浏览器会默认根据当前 URL 对资源进行重新定位（发送请求）。这个动作对 SPA 是不必要的，因为我们的 SPA 作为单页面，无论如何也只会有一个资源与之对应。此时若走正常的请求-刷新流程，反而会使用户的前进后退操作无法被记录。</li> <li>单页面应用对服务端来说，就是一个URL、一套资源，那么如何做到用“不同的URL”来映射不同的视图内容呢？</li></ul> <p>从这两个问题来看，服务端已经完全救不了这个场景了。所以要靠咱们前端自力更生，不然怎么叫“前端路由”呢？作为前端，可以提供这样的解决思路：</p> <ul><li>拦截用户的刷新操作，避免服务端盲目响应、返回不符合预期的资源内容。把刷新这个动作完全放到前端逻辑里消化掉。</li> <li>感知 URL 的变化。这里不是说要改造 URL、凭空制造出 N 个 URL 来。而是说 URL 还是那个 URL，只不过我们可以给它做一些微小的处理——这些处理并不会影响 URL 本身的性质，不会影响服务器对它的识别，只有我们前端感知的到。一旦我们感知到了，我们就根据这些变化、用 JS 去给它生成不同的内容。</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/frame/vue/3.组件通信.html" class="prev">
        三、组件通信
      </a></span> <span class="next"><a href="/frame/vue/5.VueX.html">
        五、Vuex
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.61103f05.js" defer></script><script src="/assets/js/3.5422f50d.js" defer></script><script src="/assets/js/40.f6c77657.js" defer></script>
  </body>
</html>
